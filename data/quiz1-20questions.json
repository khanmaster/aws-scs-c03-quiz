{
  "questions": [
    {
      "id": 1,
      "type": "multiple",
      "question": "A business requires a forensic logging solution for hundreds of Docker-based apps running on Amazon EC2. The solution must analyze logs in real time, provide message replay, and persist logs. Which AWS services should be employed to satisfy these requirements? (Select TWO)",
      "options": [
        "Amazon CloudWatch Logs",
        "Amazon Kinesis Data Streams",
        "Amazon SQS",
        "Amazon S3"
      ],
      "correct": [1, 3],
      "explanation": "✅ Correct: B - Real-time stream processing with replay capabilities; D - Persistent storage of logs. ❌ Incorrect: A - CloudWatch is for monitoring, not forensic replay; C - SQS is not designed for log persistence + replay.",
      "keywords": ["forensic", "logging", "Docker", "EC2", "real time", "replay"]
    },
    {
      "id": 2,
      "type": "single",
      "question": "A company developed an application by using AWS Lambda, Amazon S3, Amazon SNS, and Amazon DynamoDB. The data includes PII. The company must remove data that is older than 30 days from the S3 bucket and the DynamoDB table. Which solution will meet this requirement with the MOST operational efficiency?",
      "options": [
        "Use a Lambda function to scan and delete records every 30 days.",
        "Use S3 lifecycle policies and DynamoDB TTL.",
        "Use CloudWatch Events to schedule cleanup scripts.",
        "Enable S3 Intelligent-Tiering and DynamoDB Auto Scaling."
      ],
      "correct": [1],
      "explanation": "✅ Correct: B - S3 lifecycle policies automatically remove old objects; DynamoDB TTL deletes expired items. ❌ Incorrect: A - Manual Lambda adds unnecessary ops overhead; C - Scheduled cleanup is less efficient; D - Tiering/Auto Scaling does not handle deletion.",
      "keywords": ["Lambda", "S3", "SNS", "DynamoDB", "PII", "30 days"]
    },
    {
      "id": 3,
      "type": "multiple",
      "question": "A company is hosting a static website on Amazon S3 and serving it via CloudFront. The company has associated a WAF web ACL to restrict requests to the United States. They are worried that the S3 URL might still be directly accessible. Which combination of steps should the company take to remove direct access to the S3 URL? (Select TWO)",
      "options": [
        "Configure an S3 bucket policy to allow access only from the CloudFront Origin Access Identity (OAI).",
        "Enable versioning on the S3 bucket.",
        "Use an S3 bucket ACL to block all public access.",
        "Use an origin access control (OAC) with signed URLs."
      ],
      "correct": [0, 3],
      "explanation": "✅ Correct: A - Bucket policy + OAI ensures only CloudFront can fetch from S3; D - Origin access control (OAC) with signed URLs adds further restriction. ❌ Incorrect: B - Versioning is unrelated; C - ACL blocking breaks CloudFront access.",
      "keywords": ["S3", "CloudFront", "WAF", "direct access", "URL"]
    },
    {
      "id": 4,
      "type": "single",
      "question": "A company is testing its incident response plan for compromised credentials. The company runs a database on an Amazon EC2 instance and stores the sensitive database credentials as a secret in AWS Secrets Manager. The secret has rotation configured with an AWS Lambda function. The EC2 instance and the Lambda function are deployed in the same private subnet. The VPC has a Secrets Manager VPC endpoint. A security engineer discovers that the secret cannot rotate. Which solution will resolve this error?",
      "options": [
        "Ensure that the Lambda function has network access to the database instance.",
        "Add the SecretsManagerReadWrite policy to the Lambda execution role.",
        "Add the Lambda function to the database security group.",
        "Enable rotation on the database instead of Secrets Manager."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - Lambda must be able to connect to the DB to perform rotation. ❌ Incorrect: B - IAM isn't the root cause when the function cannot connect over the network; C - Security group configuration is part of network access; D - Rotation must be coordinated via Secrets Manager / Lambda.",
      "keywords": ["incident response", "Secrets Manager", "rotation", "Lambda", "database"]
    },
    {
      "id": 5,
      "type": "single",
      "question": "A company is evaluating the use of AWS Systems Manager Session Manager to gain access to the company's Amazon EC2 instances. When a security administrator tries to connect to a critical EC2 Linux instance during an emergency, the security administrator receives the following error: 'Error Unprotected private key file – Permissions for 'ssh/my_private_key.pem' are too open'. Which command should the security administrator use to modify the private key file permissions to resolve this error?",
      "options": [
        "chmod 400 ssh/my_private_key.pem",
        "chmod 600 ssh/my_private_key.pem",
        "chmod 700 ssh/my_private_key.pem",
        "chmod 744 ssh/my_private_key.pem"
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - chmod 400 restricts the file to be readable only by the owner, which SSH requires for private keys. ❌ Incorrect: B - chmod 600 is sometimes acceptable, but 400 is the stricter recommended mode for private keys; C - chmod 700 grants execute permission, not appropriate; D - chmod 744 leaves world-readable bits set and is not secure for private keys.",
      "keywords": ["Session Manager", "EC2", "Linux", "private key", "permissions"]
    },
    {
      "id": 6,
      "type": "single",
      "question": "A company deploys a set of standard IAM roles in AWS accounts. The IAM roles are based on job functions within the company. To balance operational efficiency and security, a security engineer implemented AWS Organizations SCPs to restrict access to critical security services in all company accounts. The security engineer needs to ensure that no one can disable Amazon GuardDuty and AWS Security Hub. Which SCP should the security engineer attach?",
      "options": [
        "An SCP that denies guardduty:DeleteDetector and securityhub:DisableSecurityHub.",
        "An SCP that allows only SecurityHub:Enable and GuardDuty:Enable.",
        "An SCP that allows all security services.",
        "An SCP that denies all actions except Security Hub and GuardDuty."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - Explicitly denying the API calls that disable those services prevents tampering while leaving other permissions intact. ❌ Incorrect: B - Allowing only those actions would be too restrictive and override normal account policies; C - Too broad; does not prevent disabling; D - Overly restrictive and breaks other functionality.",
      "keywords": ["IAM roles", "SCP", "Organizations", "GuardDuty", "Security Hub"]
    },
    {
      "id": 7,
      "type": "single",
      "question": "A company is building a data processing application that uses AWS Lambda functions. The Lambda functions need to communicate with an Amazon RDS DB instance deployed within a VPC in the same account. Which solution meets these requirements in the MOST secure way?",
      "options": [
        "Use a Lambda function with public internet access to connect to RDS.",
        "Place the Lambda function in the same VPC with appropriate security group rules.",
        "Expose RDS publicly and use TLS.",
        "Use API Gateway as a proxy for the Lambda to RDS communication."
      ],
      "correct": [1],
      "explanation": "✅ Correct: B - Deploying Lambda in the same VPC and using security groups keeps traffic private and secure. ❌ Incorrect: A - Public internet access is unnecessary and less secure; C - Public RDS exposes attack surface even if TLS is used; D - API Gateway is unnecessary for direct private DB access and adds complexity.",
      "keywords": ["Lambda", "RDS", "VPC", "secure communication"]
    },
    {
      "id": 8,
      "type": "multiple",
      "question": "A company has an application that uses an Amazon RDS PostgreSQL database. During a security review, the company discovers that the DB instance is not encrypting data at rest. The company must enable encryption for existing and new data. Which combination of options can the company use? (Select TWO)",
      "options": [
        "Create a snapshot of the DB instance, copy it with encryption, and restore a new encrypted instance.",
        "Enable encryption directly on the existing instance.",
        "Enable encryption on RDS using KMS CMKs.",
        "Migrate the data to a new encrypted DB instance."
      ],
      "correct": [0, 3],
      "explanation": "✅ Correct: A - Create a snapshot, copy with encryption, and restore to an encrypted instance; D - Migrating data to a new encrypted instance is a valid approach. ❌ Incorrect: B - You cannot toggle encryption on an existing unencrypted RDS instance; C - KMS CMKs are used, but the practical methods are snapshot-copy or migration.",
      "keywords": ["RDS", "PostgreSQL", "encryption", "data at rest"]
    },
    {
      "id": 9,
      "type": "single",
      "question": "Which of the following bucket policies will ensure that objects being uploaded to a bucket called 'demo' are encrypted?",
      "options": [
        "Deny requests without x-amz-server-side-encryption header.",
        "Allow all actions if SSL is used.",
        "Enable S3 versioning.",
        "Apply default encryption in console only."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - A deny statement that blocks uploads without the SSE header enforces encryption on upload. ❌ Incorrect: B - SSL protects transit but not server-side encryption at rest; C - Versioning is not related to encryption enforcement; D - Console default helps but a policy is needed to enforce uploads from all clients.",
      "keywords": ["S3", "bucket policy", "encryption"]
    },
    {
      "id": 10,
      "type": "multiple",
      "question": "A company uses AWS Organizations to manage a multi-account AWS environment. The company needs to automatically deploy a set of 10 AWS Config rules to all existing and future accounts. Which combination of steps will meet these requirements? (Select TWO)",
      "options": [
        "Use AWS Config Aggregator with delegated admin.",
        "Use AWS CloudFormation StackSets to deploy Config rules.",
        "Use Service Control Policies (SCPs) to enforce rules.",
        "Use AWS Config Organization Managed Rules."
      ],
      "correct": [1, 3],
      "explanation": "✅ Correct: B - CloudFormation StackSets can deploy the rule resources across all accounts; D - Organization managed rules make it simple to apply Config rules across all accounts including new ones. ❌ Incorrect: A - Aggregator collects and aggregates, it doesn't deploy rules; C - SCPs cannot enforce Config rule deployment.",
      "keywords": ["Organizations", "AWS Config", "rules", "automation"]
    },
    {
      "id": 11,
      "type": "multiple",
      "question": "A company has two AWS accounts. In Account-1, Amazon EC2 Auto Scaling launches using a service-linked role. In Account-2, Amazon EBS volumes are encrypted with an AWS KMS key. A security engineer needs to ensure that the service-linked role can launch instances with these encrypted volumes. Which combination of steps should the engineer take? (Select TWO)",
      "options": [
        "Add a key policy to allow Account-1 service-linked role to use the CMK.",
        "Create a resource policy on EC2 to allow encrypted volume access.",
        "Grant IAM permission for kms:Decrypt and kms:CreateGrant in Account-2.",
        "Create an SCP to enforce encryption on Auto Scaling."
      ],
      "correct": [0, 2],
      "explanation": "✅ Correct: A - The CMK key policy must allow the external role (or principal) to use the key; C - The role needs the proper KMS permissions (e.g., kms:CreateGrant) to attach encrypted volumes. ❌ Incorrect: B - EC2 does not have a resource policy mechanism for this purpose; D - SCPs are not the correct tool for granting cross-account KMS usage.",
      "keywords": ["EC2", "Auto Scaling", "KMS", "EBS", "cross account"]
    },
    {
      "id": 12,
      "type": "multiple",
      "question": "Which of the following are valid configurations for using SSL certificates with Amazon CloudFront? (Select THREE)",
      "options": [
        "Default CloudFront certificate (*.cloudfront.net)",
        "ACM certificate in us-east-1",
        "ACM certificate in any Region",
        "IAM certificate uploaded to CloudFront"
      ],
      "correct": [0, 1, 3],
      "explanation": "✅ Correct: A - CloudFront's default certificate covers *.cloudfront.net; B - ACM certificates used by CloudFront must be in us-east-1; D - IAM-uploaded certificates can be used with CloudFront (legacy option). ❌ Incorrect: C - ACM certs in other regions cannot be associated with CloudFront distributions.",
      "keywords": ["CloudFront", "SSL", "certificates", "ACM"]
    },
    {
      "id": 13,
      "type": "single",
      "question": "A company uses AWS SSO for access to accounts. The company wants to enforce MFA for access to the AWS Management Console, but not require MFA for CLI access. How can this requirement be met?",
      "options": [
        "Configure different permission sets for console and CLI, enforce MFA on console set.",
        "Configure AWS SSO MFA only for console access.",
        "Use an SCP to enforce MFA only on console actions.",
        "Use IAM password policy for console MFA."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - Create separate permission sets/roles and require MFA for the console permission set; CLI roles can omit the MFA requirement. ❌ Incorrect: B - AWS SSO's MFA settings are applied at sign-in; splitting by permission set is the practical approach; C - SCPs cannot differentiate console vs CLI; D - Password policies do not enforce MFA.",
      "keywords": ["SSO", "MFA", "console", "CLI"]
    },
    {
      "id": 14,
      "type": "single",
      "question": "A company must secure sensitive objects stored in Amazon S3. The security team requires that all objects are encrypted at rest and that keys are rotated automatically each year. Which solution meets these requirements?",
      "options": [
        "Use SSE-S3 (Amazon S3 managed keys).",
        "Use SSE-KMS with AWS managed CMKs with automatic rotation.",
        "Use client-side encryption libraries.",
        "Use default encryption with S3."
      ],
      "correct": [1],
      "explanation": "✅ Correct: B - SSE-KMS with customer-managed CMKs (or AWS-managed CMKs where rotation is enabled) supports key rotation. ❌ Incorrect: A - SSE-S3 does not provide annual rotation control; C - Client-side adds operational burden; D - Default encryption alone doesn't meet rotation requirements.",
      "keywords": ["S3", "encryption", "rotation", "keys"]
    },
    {
      "id": 15,
      "type": "single",
      "question": "A developer is using AWS Lambda and needs to securely store database connection strings. The solution must minimize operational overhead. Which service should the developer use?",
      "options": [
        "Store in AWS Secrets Manager.",
        "Store in Amazon S3 with SSE.",
        "Store in Lambda environment variables.",
        "Store in DynamoDB."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - AWS Secrets Manager is designed for secrets, supports rotation and minimal ops overhead. ❌ Incorrect: B - S3 is not a secrets manager; C - Env vars are less secure unless encrypted with a KMS key and managed carefully; D - DynamoDB is not intended for secrets management.",
      "keywords": ["Lambda", "database", "secrets", "secure storage"]
    },
    {
      "id": 16,
      "type": "single",
      "question": "A company has several accounts in AWS Organizations. The security team wants to ensure that all Amazon S3 buckets are encrypted by default across accounts. Which solution will meet this requirement with the LEAST operational overhead?",
      "options": [
        "Use AWS Config rule 's3-bucket-server-side-encryption-enabled'.",
        "Use SCP to enforce encryption.",
        "Require all teams to use SSE in policies.",
        "Use CloudWatch Events to trigger Lambda that applies bucket policies."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - An AWS Config rule can detect non-compliant buckets and be combined with remediation automation. ❌ Incorrect: B - SCPs can't enforce individual bucket encryption settings; C - Requiring teams manually is error-prone; D - Custom automation adds overhead compared to Config managed remediation.",
      "keywords": ["Organizations", "S3", "encryption", "compliance"]
    },
    {
      "id": 17,
      "type": "multiple",
      "question": "A company stores sensitive financial data in Amazon S3. The company wants to ensure that all access to this data is logged and that unauthorized requests are denied. Which combination of steps should the company take? (Select TWO)",
      "options": [
        "Enable server access logging on the bucket.",
        "Enable CloudTrail data events for the S3 bucket.",
        "Use default encryption.",
        "Create an S3 bucket policy to deny requests without encryption headers."
      ],
      "correct": [1, 3],
      "explanation": "✅ Correct: B - CloudTrail data events capture object-level API activity for auditing; D - A bucket policy that denies unencrypted requests helps block unauthorized/unwanted uploads. ❌ Incorrect: A - Server access logs are useful but are less granular than CloudTrail data events; C - Default encryption alone doesn't provide access logging or deny unauthorized requests.",
      "keywords": ["S3", "sensitive", "logging", "unauthorized"]
    },
    {
      "id": 18,
      "type": "multiple",
      "question": "A company is developing a multi-account strategy. The company wants to centralize security logging. Which AWS service combination can achieve this? (Select TWO)",
      "options": [
        "Use AWS CloudTrail with centralized logging bucket.",
        "Use Amazon GuardDuty with a delegated administrator.",
        "Use AWS Config aggregator only.",
        "Use Amazon Inspector across accounts."
      ],
      "correct": [0, 1],
      "explanation": "✅ Correct: A - Centralized CloudTrail to a single S3 bucket is the standard approach for unified API logs; B - GuardDuty delegated admin centralizes threat findings across accounts. ❌ Incorrect: C - Config aggregator collects compliance data but isn't a full logging solution by itself; D - Inspector provides vulnerability assessments rather than general security logging.",
      "keywords": ["multi-account", "logging", "centralized", "CloudTrail", "GuardDuty"]
    },
    {
      "id": 19,
      "type": "single",
      "question": "A company has compliance requirements that mandate encryption of all EBS volumes. Which solution provides the MOST operationally efficient way to ensure compliance?",
      "options": [
        "Use an SCP to enforce encryption.",
        "Enable EBS encryption by default in the account.",
        "Require developers to specify encryption in launch templates.",
        "Enable Config rule and remediate noncompliance manually."
      ],
      "correct": [1],
      "explanation": "✅ Correct: B - Enabling EBS encryption by default in the account ensures all new volumes are encrypted without relying on user action. ❌ Incorrect: A - SCPs don't enforce encryption settings on resource creation in the same way; C - Developer-managed solutions are error-prone; D - Manual remediation requires more operational effort.",
      "keywords": ["EBS", "encryption", "compliance"]
    },
    {
      "id": 20,
      "type": "single",
      "question": "A company is using AWS CloudTrail to monitor API calls. The security team wants to ensure that CloudTrail logs cannot be modified or deleted once delivered to S3. Which solution will meet this requirement?",
      "options": [
        "Enable S3 bucket versioning and MFA delete.",
        "Enable CloudTrail log file validation.",
        "Enable S3 server-side encryption.",
        "Use S3 lifecycle policies to archive logs."
      ],
      "correct": [0],
      "explanation": "✅ Correct: A - Versioning + MFA delete helps prevent tampering/deletion of CloudTrail logs in S3. ❌ Incorrect: B - Log file validation detects tampering but does not prevent deletion; C - Encryption protects confidentiality, not immutability; D - Lifecycle rules move or delete objects and do not prevent tampering.",
      "keywords": ["CloudTrail", "logs", "immutable", "S3"]
    }
  ]
}